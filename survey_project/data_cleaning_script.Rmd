```{r}
library(tidyverse)
```
```{r}
survey_data <- read_csv("data/synthesised_survey_data")
```
```{r}
# creating a function that quickly replaces one phrase with another 
replacement_function <- function(df, y, z) {
  df %>% 
  mutate_all(str_replace_all, y, z)
}
```

```{r}
# sourced the official names for Scottish Local Authorities from the Scottish Government website
local_authority_vector <- c("aberdeen", "aberdeenshire", "angus", "argyll and bute", "city of edinburgh", "comhairle nan eilean siar", "clackmannanshire", "dumfries and galloway", "dundee", "east ayrshire", "east dunbartonshire", "east lothian", "east renfrewshire", "falkirk", "fife", "glasgow", "highland", "inverclyde", "midlothian", "moray", "north ayrshire", "north lanarkshire", "orkney", "perth and kinross", "scottish borders", "shetland islands", "south ayrshire", "south lanarkshire", "stirling", "west dunbartonshire", "west lothian", "unknown")
```

```{r}
# cleaning up the local authority data, have replaced ayr with south ayrshire as ayr is in south ayrshire, have listed an entry of tayside as unknown as this could be either perthshire & kinross or dundee
local_authority_data <- local_authority_data %>% 
  replacement_function("pkc", "perth and kinross") %>% 
  replacement_function("^edinburgh$", "city of edinburgh") %>% 
  replacement_function("^renfrewshire$", "east renfrewshire") %>% 
  replacement_function("^borders$", "scottish borders") %>% 
  replacement_function("dumfries & galloway", "dumfries and galloway") %>% 
  replacement_function("aberdeen city", "aberdeen") %>% 
  replacement_function("grampian", "aberdeenshire") %>% 
  replacement_function("highlands", "highland") %>% 
  replacement_function("stirlingshire", "stirling") %>% 
  replacement_function("perthshire", "perth and kinross") %>% 
  replacement_function("^ayr$", "south ayrshire") %>% 
  replacement_function("perth & kinross", "perth and kinross") %>% 
  replacement_function("^lothian$", "midlothian") %>% 
  replacement_function("mid lothian", "midlothian") %>% 
  replacement_function("dont know", "unknown") %>% 
  replacement_function("aberdeenshie", "aberdeenshire") %>% 
  replacement_function("edinburgh city", "city of edinburgh") %>%
  replacement_function("tayside", "unknown") %>% 
  replacement_function("perth&kinross", "perth and kinross") %>% 
  replacement_function("scottish borders council", "scottish borders") %>% 
  replacement_function("glasgow city", "glasgow") %>% 
  replacement_function("argyll & bute", "argyll and bute")
```

```{r}
# replacing instances of other UK incorrectly entered as Scotland
local_authority_data$residence[!local_authority_data$local_authority %in% local_authority_vector & local_authority_data$residence == "scotland"] <- "other uk"
```

```{r}
# replacing an accidental swedish entry with other europe
local_authority_data$residence[local_authority_data$local_authority  == "sweden"] <- "other europe"
```

```{r}
local_authority_data %>% 
  filter(residence == "scotland") %>% 
  filter(!local_authority %in% local_authority_vector)
```

